
# 리포트 분석 로직 진단 결과 (Diagnostic Report)

지난 몇 단계에 걸친 데이터 분석 결과, 리포트가 엉뚱하게 나오는 **근본적인 원인**을 찾아냈습니다. 코드를 수정하기 전, 아이디어를 먼저 정리해 드립니다.

## 1. 근본적인 문제: 이름표(ID)의 불일치
*   **현상**: 채점 페이지(`GradingPage`)는 문제를 찾을 때 `item.id`라는 이름표를 찾습니다.
*   **실제 데이터**: 하지만 AI가 분석해온 교재 데이터(JSON)에는 `id` 대신 `question_number`라는 이름표가 붙어 있습니다.
*   **결과**: 채점을 할 때 `uuid_undefined`라는 잘못된 키로 저장되거나, 기존에 저장된 `uuid_1` 같은 데이터를 분석기가 읽어오지 못하는 현상이 발생합니다. (서로 다른 언어로 대화하는 것과 같습니다.)

## 2. 데이터 오염 (Drowning Effect)
*   **현상**: 분석기가 특정 단원(be동사)만 분석해야 하는데, 매칭되는 ID를 못 찾으니 시스템이 "아, 그럼 이 책 전체를 분석하자"라고 판단합니다.
*   **결과**: 학생이 풀지 않은 '대명사' 같은 챕터들이 "전부 맞음"으로 집계되면서, 실제 공부한 'be동사' 데이터가 희석되어 버립니다.

## 3. 해결을 위한 아이디어 정리
코드를 무작정 고치지 않고, 다음과 같이 설계를 정렬해야 합니다.

1.  **식별자 통일**: `id`와 `question_number`를 하나로 합쳐서, 어떤 이름표가 붙어있든 똑똑하게 찾아내도록 '매칭 브릿지'를 만듭니다.
2.  **분석 범위 엄격 제한**: "채점 데이터에 없는 문제는 아예 분석 대상에서 제외"하도록 로직을 확정합니다. (그래야 풀지도 않은 대명사 얘기가 안 나옵니다.)
3.  **과거 데이터 호환**: 이미 ID가 꼬여서 저장된 예전 채점 데이터들도 최대한 살릴 수 있도록, '문제 번호' 기반의 매칭 로직을 보강합니다.

위 내용에 대해 동의하신다면, 이 설계를 바탕으로 **정확하고 안전한 한 번의 수정**을 진행하겠습니다.
